-- SG
select
    xfer_sg.ID as ORDER_NUMBER,
    xfer_sg.WFC_STATUS_ID as STATUS,
    xfer_sg.INS_BY_SEC_USER_ID as INSERTED_BY,
    bu_sg.BU_ABBREVIATION as BUSINESS_UNIT,
    xfer_sg.ORDER_TYPE_ID as ORDER_TYPE,
    xfer_sg.ORDERED_BY as ORDERED_BY,
    xfer_sg.BOOK_KIND_ID as BOOKING_KIND,
    xfer_sg.TRX_DATE as TRADE_DATE,
    xfer_sg.VAL_DATE as VALUE_DATE,
    xfer_sg.DEB_BP_ID as DEBIT_BP_KEY,
    xfer_sg.DEB_CONT_ID as DEBIT_CONTAINER_KEY,
    xfer_sg.DEB_COST_MACC_ID as COST,
    curry_sg.CURRY_CODE as COST_CCY,
    xfer_sg.CRED_BP_ID as CREDIT_BP_KEY,
    xfer_sg.CRED_CONT_ID as CREDIT_CONTAINER_KEY,
    xfer_sg.DEB_POS_ID as DEBIT_POSITION,
    xfer_sg.QTY as QUANTITY,
    xfer_sg.MV as MARKET_VALUE,
    (select CURRY_CODE from PBDM_CURRY where CURRY_ID = xfer_sg.DEB_COST_CURRY_ID) as CURRECNY,
    (select key_sg.VAL from AVQ_DWH_OBJ_ASSET_KEY_LIST_SG key_sg join AVQ_DWH_OBJ_POS_SG pos_sg on pos_sg.ASSET_ID = key_sg.ID join AVQ_DWH_DOC_XFER_SG xfer_sg on xfer_sg.DEB_POS_ID = pos_sg.POS_ID where key_sg.OBJ_KEY_ID = 'asset_isin') as ISIN,
    xfer_sg.CRED_POS_ID as CREDIT_POSITION,
    NULL as SOLICITED,
    NULL as SOLICITED_BY,
    NULL as SOLICITED_DATE,
    NULL as ORDER_PLACED_VIA,
    NULL as DATE_TIME_PHONE_EXTENSION,
    NULL as SUITABILITY_ASSESSMENT_RESULT,
    NULL as INVESTMENT_RATIONALE_1_TO_7,
    NULL as INVESTMENT_JUSTIFICATION_COMMENT_BOX,
    NULL as ALTERNATIVE_INVESTMENT_PRODUCT,
    NULL as ACCOUNTED_DATE,
    NULL as BO_ORDER_MAKER,
    NULL as BO_ORDER_CHECKER,
    NULL as ED_APPROVE,
    NULL as ED_REJECT,
    NULL as ED_APPROVE_TIME,
    NULL as ED_REJECT_TIME,
    NULL as FO_SUPERVISOR_APPROVE,
    NULL as FO_SUPERVISOR_REJECT,
    NULL as FO_SUPERVISOR_APPROVE_TIME,
    NULL as FO_SUPERVISOR_REJECT_TIME,
    NULL as REVERSE_USER,
    NULL as REVERSE_TIME,
    NULL as MODIFY_ORDER_TIME,
    NULL as MODIFY_ORDER_ASSET_PRICE,
    NULL as MODIFY_ORDER_ASSET_QUANTITY,
    NULL as MODIFY_ORDER_PERSON,
    NULL as PTCC_MISTACH_ITEM,
    NULL as APPROVAL_BY_PTCC,
    NULL as APPROVAL_DATE_PTCC,
    NULL as RECORD_OF_SOFT_BLOCK,
    NULL as TIME_OF_SOFT_BLOCK,
    NULL as POST_IT_OF_SOFT_BLOCK,
    NULL as INITATOR,
    (select top 1 BUSINESSDAY from PBDM_BUSINESS_DAY where entity = 'GLOBAL') as BUSINESSDAY
from AVQ_DWH_DOC_XFER_SG xfer_sg
left join PBDM_BU bu_sg on bu_sg.BU_ID = xfer_sg.BU_ID
left join PBDM_CURRY curry_sg on curry_sg.CURRY_ID = xfer_sg.DEB_COST_CURRY_ID
left join AVQ_DWH_OBJ_POS_SG pos_sg on pos_sg.POS_ID = xfer_sg.DEB_POS_ID
union all
-- HK
select
    xfer_hk.ID as ORDER_NUMBER,
    xfer_hk.WFC_STATUS_ID as STATUS,
    xfer_hk.INS_BY_SEC_USER_ID as INSERTED_BY,
    bu_hk.BU_ABBREVIATION as BUSINESS_UNIT,
    xfer_hk.ORDER_TYPE_ID as ORDER_TYPE,
    xfer_hk.ORDERED_BY as ORDERED_BY,
    xfer_hk.BOOK_KIND_ID as BOOKING_KIND,
    xfer_hk.TRX_DATE as TRADE_DATE,
    xfer_hk.VAL_DATE as VALUE_DATE,
    xfer_hk.DEB_BP_ID as DEBIT_BP_KEY,
    xfer_hk.DEB_CONT_ID as DEBIT_CONTAINER_KEY,
    xfer_hk.DEB_COST_MACC_ID as COST,
    curry_hk.CURRY_CODE as COST_CCY,
    xfer_hk.CRED_BP_ID as CREDIT_BP_KEY,
    xfer_hk.CRED_CONT_ID as CREDIT_CONTAINER_KEY,
    xfer_hk.DEB_POS_ID as DEBIT_POSITION,
    xfer_hk.QTY as QUANTITY,
    xfer_hk.MV as MARKET_VALUE,
    (select CURRY_CODE from PBDM_CURRY where CURRY_ID = xfer_hk.DEB_COST_CURRY_ID) as CURRECNY,
    (select key_hk.VAL from AVQ_DWH_OBJ_ASSET_KEY_LIST_HK key_hk join AVQ_DWH_OBJ_pos_hk pos_hk on pos_hk.ASSET_ID = key_hk.ID join AVQ_DWH_DOC_XFER_HK xfer_hk on xfer_hk.DEB_POS_ID = pos_hk.POS_ID where key_hk.OBJ_KEY_ID = 'asset_isin') as ISIN,
    xfer_hk.CRED_POS_ID as CREDIT_POSITION,
    NULL as SOLICITED,
    NULL as SOLICITED_BY,
    NULL as SOLICITED_DATE,
    NULL as ORDER_PLACED_VIA,
    NULL as DATE_TIME_PHONE_EXTENSION,
    NULL as SUITABILITY_ASSESSMENT_RESULT,
    NULL as INVESTMENT_RATIONALE_1_TO_7,
    NULL as INVESTMENT_JUSTIFICATION_COMMENT_BOX,
    NULL as ALTERNATIVE_INVESTMENT_PRODUCT,
    NULL as ACCOUNTED_DATE,
    NULL as BO_ORDER_MAKER,
    NULL as BO_ORDER_CHECKER,
    NULL as ED_APPROVE,
    NULL as ED_REJECT,
    NULL as ED_APPROVE_TIME,
    NULL as ED_REJECT_TIME,
    NULL as FO_SUPERVISOR_APPROVE,
    NULL as FO_SUPERVISOR_REJECT,
    NULL as FO_SUPERVISOR_APPROVE_TIME,
    NULL as FO_SUPERVISOR_REJECT_TIME,
    NULL as REVERSE_USER,
    NULL as REVERSE_TIME,
    NULL as MODIFY_ORDER_TIME,
    NULL as MODIFY_ORDER_ASSET_PRICE,
    NULL as MODIFY_ORDER_ASSET_QUANTITY,
    NULL as MODIFY_ORDER_PERSON,
    NULL as PTCC_MISTACH_ITEM,
    NULL as APPROVAL_BY_PTCC,
    NULL as APPROVAL_DATE_PTCC,
    NULL as RECORD_OF_SOFT_BLOCK,
    NULL as TIME_OF_SOFT_BLOCK,
    NULL as POST_IT_OF_SOFT_BLOCK,
    NULL as INITATOR,
    (select top 1 BUSINESSDAY from PBDM_BUSINESS_DAY where entity = 'GLOBAL') as BUSINESSDAY
from AVQ_DWH_DOC_XFER_HK xfer_hk
left join PBDM_BU bu_hk on bu_hk.BU_ID = xfer_hk.BU_ID
left join PBDM_CURRY curry_hk on curry_hk.CURRY_ID = xfer_hk.DEB_COST_CURRY_ID
left join AVQ_DWH_OBJ_POS_HK pos_hk on pos_hk.POS_ID = xfer_hk.DEB_POS_ID